
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JavaScript each function - php.js</title>
  <meta name="author" content="Kevin van Zonneveld">

  
  <meta name="description" content="JavaScript each function A JavaScript equivalent of PHP&#8217;s each array/each.js raw on github 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phpjs.org/functions/each/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="php.js" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-63083-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">php</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">.js</a></h1>
  
    <h2>A resource of php functions in JavaScript</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phpjs.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/functions">Functions</a></li>
  <li><a href="/authors">Authors</a></li>
  <li><a target="_blank" href="https://github.com/kvz/phpjs/wiki/_pages">Wiki</a></li>
  <li><a target="_blank"  href="http://twitter.com/phpjs">@phpjs</a></li>
  <li><a target="_blank"  href="http://identi.ca/brettz9">@brettz9</a></li>
  <li><a target="_blank"  href="http://twitter.com/kvz">@kvz</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">JavaScript each function</h1>
    
  </header>
  
  <!-- Generated by Rakefile:build -->


<p>A JavaScript equivalent of PHP&#8217;s each</p>

<figure class='code'><figcaption><span>array/each.js </span><a href='https://raw.github.com/kvz/phpjs/master/functions/array/each.js'>raw on github </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">each</span> <span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// http://kevin.vanzonneveld.net</span>
</span><span class='line'>  <span class="c1">// +   original by: Ates Goral (http://magnetiq.com)</span>
</span><span class='line'>  <span class="c1">// +    revised by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// %        note 1: Uses global: php_js to store the array pointer</span>
</span><span class='line'>  <span class="c1">// *     example 1: each({a: &quot;apple&quot;, b: &quot;balloon&quot;});</span>
</span><span class='line'>  <span class="c1">// *     returns 1: {0: &quot;a&quot;, 1: &quot;apple&quot;, key: &quot;a&quot;, value: &quot;apple&quot;}</span>
</span><span class='line'>  <span class="c1">//  Will return a 4-item object unless a class property &#39;returnArrayOnly&#39;</span>
</span><span class='line'>  <span class="c1">//  is set to true on this function if want to only receive a two-item</span>
</span><span class='line'>  <span class="c1">//  numerically-indexed array (for the sake of array destructuring in</span>
</span><span class='line'>  <span class="c1">//  JavaScript 1.7+ (similar to list() in PHP, but as PHP does it automatically</span>
</span><span class='line'>  <span class="c1">//  in that context and JavaScript cannot, we needed something to allow that option)</span>
</span><span class='line'>  <span class="c1">//  See https://developer.mozilla.org/en/New_in_JavaScript_1.7#Destructuring_assignment</span>
</span><span class='line'>  <span class="c1">// BEGIN REDUNDANT</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">php_js</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">php_js</span> <span class="o">||</span> <span class="p">{};</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">php_js</span><span class="p">.</span><span class="nx">pointers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">php_js</span><span class="p">.</span><span class="nx">pointers</span> <span class="o">||</span> <span class="p">[];</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">indexOf</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="c1">// END REDUNDANT</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">pointers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">php_js</span><span class="p">.</span><span class="nx">pointers</span><span class="p">;</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">pointers</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">pointers</span><span class="p">.</span><span class="nx">indexOf</span> <span class="o">=</span> <span class="nx">indexOf</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">pointers</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">pointers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">arrpos</span> <span class="o">=</span> <span class="nx">pointers</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">cursor</span> <span class="o">=</span> <span class="nx">pointers</span><span class="p">[</span><span class="nx">arrpos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;[object Array]&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">ct</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">ct</span> <span class="o">===</span> <span class="nx">cursor</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">pointers</span><span class="p">[</span><span class="nx">arrpos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">each</span><span class="p">.</span><span class="nx">returnArrayOnly</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="p">[</span><span class="nx">k</span><span class="p">,</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">k</span><span class="p">]];</span>
</span><span class='line'>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>            <span class="mi">1</span><span class="o">:</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span>
</span><span class='line'>            <span class="nx">value</span><span class="o">:</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span>
</span><span class='line'>            <span class="mi">0</span><span class="o">:</span> <span class="nx">k</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">key</span><span class="o">:</span> <span class="nx">k</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">ct</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span> <span class="c1">// Empty</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">cursor</span> <span class="o">===</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nx">pos</span> <span class="o">=</span> <span class="nx">cursor</span><span class="p">;</span>
</span><span class='line'>  <span class="nx">pointers</span><span class="p">[</span><span class="nx">arrpos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">each</span><span class="p">.</span><span class="nx">returnArrayOnly</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">[</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">pos</span><span class="p">]];</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>      <span class="mi">1</span><span class="o">:</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">pos</span><span class="p">],</span>
</span><span class='line'>      <span class="nx">value</span><span class="o">:</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">pos</span><span class="p">],</span>
</span><span class='line'>      <span class="mi">0</span><span class="o">:</span> <span class="nx">pos</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">key</span><span class="o">:</span> <span class="nx">pos</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/kvz/phpjs/blob/master/functions/array/each.js">view on github</a></li>
<li><a href="https://github.com/kvz/phpjs/edit/master/functions/array/each.js">edit on github</a></li>
</ul>


<h3>Example 1</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">each</span><span class="p">({</span><span class="nx">a</span><span class="o">:</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="s2">&quot;balloon&quot;</span><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="p">{</span><span class="mi">0</span><span class="o">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="nx">key</span><span class="o">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s2">&quot;apple&quot;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other PHP functions in the array extension</h3>

<!-- Generated by Rakefile:build -->


<ul>
<li><a href="/functions/array">array</a></li>
<li><a href="/functions/array_change_key_case">array_change_key_case</a></li>
<li><a href="/functions/array_chunk">array_chunk</a></li>
<li><a href="/functions/array_combine">array_combine</a></li>
<li><a href="/functions/array_count_values">array_count_values</a></li>
<li><a href="/functions/array_diff">array_diff</a></li>
<li><a href="/functions/array_diff_assoc">array_diff_assoc</a></li>
<li><a href="/functions/array_diff_key">array_diff_key</a></li>
<li><a href="/functions/array_diff_uassoc">array_diff_uassoc</a></li>
<li><a href="/functions/array_diff_ukey">array_diff_ukey</a></li>
<li><a href="/functions/array_fill">array_fill</a></li>
<li><a href="/functions/array_fill_keys">array_fill_keys</a></li>
<li><a href="/functions/array_filter">array_filter</a></li>
<li><a href="/functions/array_flip">array_flip</a></li>
<li><a href="/functions/array_intersect">array_intersect</a></li>
<li><a href="/functions/array_intersect_assoc">array_intersect_assoc</a></li>
<li><a href="/functions/array_intersect_key">array_intersect_key</a></li>
<li><a href="/functions/array_intersect_uassoc">array_intersect_uassoc</a></li>
<li><a href="/functions/array_intersect_ukey">array_intersect_ukey</a></li>
<li><a href="/functions/array_key_exists">array_key_exists</a></li>
<li><a href="/functions/array_keys">array_keys</a></li>
<li><a href="/functions/array_map">array_map</a></li>
<li><a href="/functions/array_merge">array_merge</a></li>
<li><a href="/functions/array_merge_recursive">array_merge_recursive</a></li>
<li><a href="/functions/array_multisort">array_multisort</a></li>
<li><a href="/functions/array_pad">array_pad</a></li>
<li><a href="/functions/array_pop">array_pop</a></li>
<li><a href="/functions/array_product">array_product</a></li>
<li><a href="/functions/array_push">array_push</a></li>
<li><a href="/functions/array_rand">array_rand</a></li>
<li><a href="/functions/array_reduce">array_reduce</a></li>
<li><a href="/functions/array_replace">array_replace</a></li>
<li><a href="/functions/array_replace_recursive">array_replace_recursive</a></li>
<li><a href="/functions/array_reverse">array_reverse</a></li>
<li><a href="/functions/array_search">array_search</a></li>
<li><a href="/functions/array_shift">array_shift</a></li>
<li><a href="/functions/array_slice">array_slice</a></li>
<li><a href="/functions/array_splice">array_splice</a></li>
<li><a href="/functions/array_sum">array_sum</a></li>
<li><a href="/functions/array_udiff">array_udiff</a></li>
<li><a href="/functions/array_udiff_assoc">array_udiff_assoc</a></li>
<li><a href="/functions/array_udiff_uassoc">array_udiff_uassoc</a></li>
<li><a href="/functions/array_uintersect">array_uintersect</a></li>
<li><a href="/functions/array_uintersect_assoc">array_uintersect_assoc</a></li>
<li><a href="/functions/array_uintersect_uassoc">array_uintersect_uassoc</a></li>
<li><a href="/functions/array_unique">array_unique</a></li>
<li><a href="/functions/array_unshift">array_unshift</a></li>
<li><a href="/functions/array_values">array_values</a></li>
<li><a href="/functions/array_walk">array_walk</a></li>
<li><a href="/functions/array_walk_recursive">array_walk_recursive</a></li>
<li><a href="/functions/arsort">arsort</a></li>
<li><a href="/functions/asort">asort</a></li>
<li><a href="/functions/compact">compact</a></li>
<li><a href="/functions/count">count</a></li>
<li><a href="/functions/current">current</a></li>
<li><a href="/functions/each">each</a></li>
<li><a href="/functions/end">end</a></li>
<li><a href="/functions/extract">extract</a></li>
<li><a href="/functions/in_array">in_array</a></li>
<li><a href="/functions/key">key</a></li>
<li><a href="/functions/krsort">krsort</a></li>
<li><a href="/functions/ksort">ksort</a></li>
<li><a href="/functions/natcasesort">natcasesort</a></li>
<li><a href="/functions/natsort">natsort</a></li>
<li><a href="/functions/next">next</a></li>
<li><a href="/functions/pos">pos</a></li>
<li><a href="/functions/prev">prev</a></li>
<li><a href="/functions/range">range</a></li>
<li><a href="/functions/reset">reset</a></li>
<li><a href="/functions/rsort">rsort</a></li>
<li><a href="/functions/shuffle">shuffle</a></li>
<li><a href="/functions/sizeof">sizeof</a></li>
<li><a href="/functions/sort">sort</a></li>
<li><a href="/functions/uasort">uasort</a></li>
<li><a href="/functions/uksort">uksort</a></li>
<li><a href="/functions/usort">usort</a></li>
</ul>


<h2>Legacy comments</h2>

<p>These were imported from our old site. Please use disqus below for new comments</p>

<div style="overflow-y: scroll; max-height: 500px;">
<!-- Generated by Rakefile:build -->

<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2009-01-06 14:01:10 <br />
@ Brett Zamir: Nice dude :)
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-01-01 03:50:27 <br />
By the way, I noticed now that there is a built-in way in JavaScript 1.7 to do the each() iteration: using Iterator() (and otherwise progress through arrays/objects).  See https://developer.mozilla.org/en/New_in_JavaScript_1.7#Looping_across_objects and https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Iterators_and_Generators#Iterators

Still, it shouldn&#8217;t hurt to have them with the PHP equivalents (I think the PHP way is easier)&#8230;

Brett
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-01-01 03:28:57 <br />
Hi Kevin,

I think I got it working now&#8230;

Thanks for the offer&#8230; Although I don&#8217;t drink (I&#8217;m a Baha&#8217;i), if I did drink, I&#8217;d be glad to have one with you&#8230; You seem like a most gracious person&#8230; Have a happy new year&#8230; And Onno too&#8211;thanks for keeping me on my toes, you guys&#8230; :)

<pre><code>function pos (arr) { // Alias of current
  return current(arr);
}
function current (arr) {
  if (!window.php_js) window.php_js = {pointers:[]};
  var pointers = window.php_js.pointers;
  if (pointers.indexOf(arr) === -1) {
    pointers.push(arr, 0);
  }
  var arrpos = pointers.indexOf(arr);
  var cursor = pointers[arrpos+1];
  if (arr instanceof Array) {
    return arr[cursor] || false;
  }
  var ct = 0;
  for (var k in arr) {
    if (ct === cursor) {
      return arr[k];
    }
    ct++;
  }
  return false; // Empty
}
function next (arr) {
  if (!window.php_js) window.php_js = {pointers:[]};
  var pointers = window.php_js.pointers;
  if (pointers.indexOf(arr) === -1) {
    pointers.push(arr, 0);
  }
  var arrpos = pointers.indexOf(arr);
  var cursor = pointers[arrpos+1];
  if (!(arr instanceof Array)) {
    var ct = 0;
    for (var k in arr) {
      if (ct === cursor+1) {
        pointers[arrpos+1] += 1;
        return arr[k];
      }
      ct++;
    }
    return false; // End
  }
  if (arr.length === 0 || cursor === (arr.length-1)) {
      return false;
  }
  pointers[arrpos+1] += 1;
  return arr[pointers[arrpos+1]];
}
function prev (arr) {
  if (!window.php_js) window.php_js = {pointers:[]};
  var pointers = window.php_js.pointers;
  var arrpos = pointers.indexOf(arr);
  var cursor = pointers[arrpos+1];
  if (pointers.indexOf(arr) === -1 || cursor === 0) {
    return false;
  }
  if (!(arr instanceof Array)) {
    var ct = 0;
    for (var k in arr) {
      if (ct === cursor-1) {
        pointers[arrpos+1] -= 1;
        return arr[k];
      }
      ct++;
    }
    // Shouldn't reach here
  }
  if (arr.length === 0) {
    return false;
  }
  pointers[arrpos+1] -= 1;
  return arr[pointers[arrpos+1]];
}
function reset (arr) {
  if (!window.php_js) window.php_js = {pointers:[]};
  var pointers = window.php_js.pointers;
  if (pointers.indexOf(arr) === -1) {
    pointers.push(arr, 0);
  }
  var arrpos = pointers.indexOf(arr);
  if (!(arr instanceof Array)) {
    for (var k in arr) {
      if (pointers.indexOf(arr) === -1) {
       pointers.push(arr, 0);
      }
      else {
        pointers[arrpos+1] = 0;
      }
      return arr[k];
    }
    return false; // Empty
  }
  if (arr.length === 0) {
    return false;
  }
  pointers[arrpos+1] = 0;
  return arr[pointers[arrpos+1]];
}
function end (arr) {
  if (!window.php_js) window.php_js = {pointers:[]};
  var pointers = window.php_js.pointers;
  if (pointers.indexOf(arr) === -1) {
    pointers.push(arr, 0);
  }
  var arrpos = pointers.indexOf(arr);
  if (!(arr instanceof Array)) {
    var ct = 0;
    for (var k in arr) {
      ct++;
      var val = arr[k];
    }
    if (ct === 0) {
      return false; // Empty
    }
    pointers[arrpos+1] = ct - 1;
    return val;
  }
  if (arr.length === 0) {
    return false;
  }
  pointers[arrpos+1] = arr.length - 1;
  return arr[pointers[arrpos+1]];
}
function key (arr) {
  if (!window.php_js) window.php_js = {pointers:[]};
  var pointers = window.php_js.pointers;
  if (pointers.indexOf(arr) === -1) {
    pointers.push(arr, 0);
  }
  var cursor = pointers[pointers.indexOf(arr)+1];
  if (!(arr instanceof Array)) {
    var ct = 0;
    for (var k in arr) {
      if (ct === cursor) {
        return k;
      }
      ct++;
    }
    return false; // Empty
  }
  if (arr.length === 0) {
    return false;
  }
  return cursor;
}
function each (arr) {
  // Will return a 4-item object unless a class property 'returnArrayOnly' is set to true on this function if want to only receive a two-item numerically-indexed array (for the sake of array destructuring in JavaScript 1.7+ (similar to list() in PHP, but as PHP does it automatically in that context and JavaScript cannot, we needed something to allow that option)
  //   See https://developer.mozilla.org/en/New_in_JavaScript_1.7#Destructuring_assignment
  if (!window.php_js) window.php_js = {pointers:[]};
  var pointers = window.php_js.pointers;
  if (pointers.indexOf(arr) === -1) {
    pointers.push(arr, 0);
  }
  var arrpos = pointers.indexOf(arr);
  var cursor = pointers[arrpos+1];
  if (!(arr instanceof Array)) {
    var ct = 0;
    for (var k in arr) {
      if (ct === cursor) {
        pointers[arrpos+1] += 1;
        if (each.returnArrayOnly) {
          return [k, arr[k]];  
        }
        else {
          return {1:arr[k], value:arr[k], 0:k, key:k};
        }
      }
      ct++;
    }
    return false; // Empty
  }
  if (arr.length === 0 || cursor === arr.length) {
    return false;
  }
  pos = cursor;
  pointers[arrpos+1] += 1;
  if (each.returnArrayOnly) {
    return [pos, arr[pos]];  
  }
  else {
    return {1:arr[pos], value:arr[pos], 0:pos, key:pos};
  }
}
</code></pre>
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-12-31 13:19:04 <br />
@ Brett Zamir: You&#8217;re onto something there! I&#8217;m sure we&#8217;ll work it out next year ;) Guys, best wishes and have a good one tonight. Have a drink from me will you?

And let 2009 be a happy &amp;amp; successful year for you &amp;amp; your projects :) Regards!
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2008-12-30 18:19:10 <br />
Yeah, that&#8217;s a good point about serialization.

Since we can&#8217;t get unique memory addresses directly in JavaScript (thank heavens!) (and toSource() as an id would not distinguish between arrays with the same values), I think what we might try is to store their references directly (for the sake of later comparison) like this along with the key:

<pre><code>var pointers = window.php_js.pointers;
if (pointers.indexOf(arr) === -1) {
    pointers.push(arr, incrementVal);
}
else {
    pointers[pointers.indexOf(arr)+1] += incrementVal; // Or do whatever needed to be done
}
</code></pre>

I&#8217;ll try to look into that later (unless you&#8217;re so inspired), as well as get back to you on the constants function&#8230; All the best&#8230;
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-12-30 12:05:49 <br />
@ Brett Zamir: That&#8217;s some hard labour there Brett. And it makes me smile that with these functions you could actually do this:
<pre><code>
reset($fruit);
while ([$key, $val] = each($fruit)) {
    echo ($key +&amp;quot;:&amp;quot;+ $val+&amp;quot;\n&amp;quot;);
}
</code></pre>
In JavaScript :) So kuddo&#8217;s to you man.

But (sorry, there always is a but) before adding, I do not feel comfortable storing the pointer inside the userobject. This may introduce the infamous Heisenbug. 

Imagine you have an important object that stores user information. You work on it using reset &amp;amp; each (you do not expect these to alter your data in any way), serialize it, and finally send it to the server.
Now the serialized information will contain a strange element: &#8216;_phpjs_pos&#8217; that may lead to all kind of unexpected results. It may cause unaware developers some hard time debugging, and may (in some rare cases but still) even lead to server side data corruption. In short, this is not something I can willingly introduce to the project.

I&#8217;d rather it be stored in the window.php_js global variable, as we already have such a mechanism for include_once. So we&#8217;re not introducing additional dirt.

I imagine something like:
<pre><code>
window.php_js.pointers[pointerId] = key;
</code></pre>

One challenge of that approach is that we&#8217;d have to figure out a way to add the scope to the so-called pointerId. But if we cannot overcome that I have some strong issues with adding these current implementations. 

Can you guys share this opinion?
<hr />


<strong>
Brett Zamir
</strong>
on 2008-12-20 17:59:02 <br />
While the above functioning works fine from what I can tell (besides not offering to return a regular array in circumstances as is useful with destructuring assignment in JavaScript 1.7), in order to maintain pointer state in a way which would work across all such functions (and also make the array key a little more &amp;quot;namespaced&amp;quot;), I rewrote each() as well as added all of the following functions. I hadn&#8217;t thought about using a property on the array to preserve the pointer position until now, so I was mistaken in thinking it not possible to do this in JavaScript.

&#8230;Examples are adapted from the PHP manual&#8230;Note that the pointer property is not reset by other JavaScript actions as it might be in PHP (e.g., assigning an array to another variable).



<pre><code>$foo = {&amp;quot;Robert&amp;quot; : &amp;quot;Bob&amp;quot;, &amp;quot;Seppo&amp;quot; : &amp;quot;Sepi&amp;quot;};
$bar = each($foo);
var_dump($bar)

$fruit = {'a' : 'apple', 'b' : 'banana', 'c' : 'cranberry'};

reset($fruit);
while ([$key, $val] = each($fruit)) {
    alert( $key +&amp;quot;:&amp;quot;+ $val+&amp;quot;\n&amp;quot;);
}


$transport = new Array('foot', 'bike', 'car', 'plane');
// $transport = {a:2, b:3}; // Tried also with this
$mode = current($transport); // $mode = 'foot';
$mode = next($transport);    // $mode = 'bike';
$mode = current($transport); // $mode = 'bike';
$mode = prev($transport);    // $mode = 'foot';
$mode = end($transport);     // $mode = 'plane';
$mode = current($transport); // $mode = 'plane';

$arr = [];
var_dump(current($arr)); // bool(false)

$arr = new Array([]);
var_dump(current($arr)); // array(0) { }
 

function pos (arr) { // Alias of current
    return current(arr);
}
function current (arr) {
    if (!arr._phpjs_pos) {
        arr._phpjs_pos = 0;
    }
    if (arr instanceof Array) {
        return arr[arr._phpjs_pos] || false;
    }
    var ct = 0;
    for (var k in arr) {
        if (k !== '_phpjs_pos') {
            if (ct === arr._phpjs_pos) {
                return arr[k];
            }
            ct++;
        }
    }
    return false; // Empty
}
function next (arr) {
    if (!arr._phpjs_pos) {
        arr._phpjs_pos = 0;
    }
    if (!(arr instanceof Array)) {
        var ct = 0;
        for (var k in arr) {
            if (k !== '_phpjs_pos') {
                if (ct === arr._phpjs_pos+1) {
                    arr._phpjs_pos += 1;
                    return arr[k];
                }
                ct++;
            }
        }
        return false; // End
    }
    if (arr.length === 0 || arr._phpjs_pos === (arr.length-1)) {
        return false;
    }
    arr._phpjs_pos += 1;
    return arr[arr._phpjs_pos];
}
function prev (arr) {
    if (arr._phpjs_pos === 0 || arr._phpjs_pos === undefined) {
        return false;
    }
    if (!(arr instanceof Array)) {
        var ct = 0;
        for (var k in arr) {
            if (k !== '_phpjs_pos') {
                if (ct === arr._phpjs_pos-1) {
                    arr._phpjs_pos -= 1;
                    return arr[k];
                }
                ct++;
            }
        }
        // Shouldn't reach here
    }
    if (arr.length === 0) {
        return false;
    }
    arr._phpjs_pos -= 1;
    return arr[arr._phpjs_pos];
}
function reset (arr) {
    if (!(arr instanceof Array)) {
        for (var k in arr) {
            if (k !== '_phpjs_pos') {
                arr._phpjs_pos = 0;
                return arr[k];
            }
        }
        return false; // Empty
    }
    if (arr.length === 0) {
        return false;
    }
    arr._phpjs_pos = 0;
    return arr[arr._phpjs_pos];
}
function end (arr) {
    if (!(arr instanceof Array)) {
        var ct = 0;
        for (var k in arr) {
            if (k !== '_phpjs_pos') {
                ct++;
                var val = arr[k];
            }
        }
        if (ct === 0) {
            return false; // Empty
        }
        arr._phpjs_pos = ct - 1;
        return val;
    }
    if (arr.length === 0) {
        return false;
    }
    arr._phpjs_pos = arr.length - 1;
    return arr[arr._phpjs_pos];
}
function key (arr) {
        if (!arr._phpjs_pos) {
        arr._phpjs_pos = 0;
    }
    if (!(arr instanceof Array)) {
        var ct = 0;
        for (var k in arr) {
            if (k !== '_phpjs_pos') {
                if (ct === arr._phpjs_pos) {
                    return k;
                }
                ct++;
            }
        }
        return false; // Empty
    }
    if (arr.length === 0) { // Todo: verify this is result (and return false just above)
        return false;
    }
    return arr._phpjs_pos !== undefined ? arr._phpjs_pos : 0;
}
function each (arr) {
    // Will return a 4-item object unless a class property 'returnArrayOnly' is set to true on this function if want to only receive a two-item numerically-indexed array (for the sake of array destructuring in JavaScript 1.7+ (similar to list() in PHP, but as PHP does it automatically in that context and JavaScript cannot, we needed something to allow that option)
    //  See https://developer.mozilla.org/en/New_in_JavaScript_1.7#Destructuring_assignment
    if (!arr._phpjs_pos) {
        arr._phpjs_pos = 0;
    }
    if (!(arr instanceof Array)) {
        var ct = 0;
        for (var k in arr) {
            if (k !== '_phpjs_pos') {
                if (ct === arr._phpjs_pos) {
                    arr._phpjs_pos += 1;
                    if (each.returnArrayOnly) {
                        return [k, arr[k]]; 
                    }
                    else {
                        return {1:arr[k], value:arr[k], 0:k, key:k};
                    }
                }
                ct++;
            }
        }
        return false; // Empty
    }
    if (arr.length === 0 || arr._phpjs_pos === arr.length) {
        return false;
    }
    pos = arr._phpjs_pos;
    arr._phpjs_pos += 1;
    if (each.returnArrayOnly) {
        return [pos, arr[pos]]; 
    }
    else {
        return {1:arr[pos], value:arr[pos], 0:pos, key:pos};
    }
}
</code></pre>
<hr />


</div>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://phpjs.org/functions/each/index.html" data-via="phpjs" data-counturl="http://phpjs.org/functions/each/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Kevin van Zonneveld -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
   -
  <span class="credit">Theme by <a href="http://melandri.net/2012/07/23/darkstripes-octopress-theme-released/">alessandro melandri</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phpjs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://phpjs.org/functions/each/index.html';
        var disqus_url = 'http://phpjs.org/functions/each/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
