
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JavaScript str_word_count function - php.js</title>
  <meta name="author" content="Kevin van Zonneveld">

  
  <meta name="description" content="JavaScript str_word_count function A JavaScript equivalent of PHP&#8217;s str_word_count strings/str_word_count.js raw on github 1
2
3
4
5
6
7
8
9 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phpjs.org/functions/str_word_count/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="php.js" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-63083-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">php</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">.js</a></h1>
  
    <h2>A resource of php functions in JavaScript</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phpjs.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/functions">Functions</a></li>
  <li><a href="/authors">Authors</a></li>
  <li><a target="_blank" href="https://github.com/kvz/phpjs/wiki/_pages">Wiki</a></li>
  <li><a target="_blank"  href="http://twitter.com/phpjs">@phpjs</a></li>
  <li><a target="_blank"  href="http://identi.ca/brettz9">@brettz9</a></li>
  <li><a target="_blank"  href="http://twitter.com/kvz">@kvz</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">JavaScript str_word_count function</h1>
    
  </header>
  
  <!-- Generated by Rakefile:build -->


<p>A JavaScript equivalent of PHP&#8217;s str_word_count</p>

<figure class='code'><figcaption><span>strings/str_word_count.js </span><a href='https://raw.github.com/kvz/phpjs/master/functions/strings/str_word_count.js'>raw on github </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">str_word_count</span> <span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">format</span><span class="p">,</span> <span class="nx">charlist</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// http://kevin.vanzonneveld.net</span>
</span><span class='line'>  <span class="c1">// +   original by: Ole Vrijenhoek</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// +   input by: Bug?</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// +   improved by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// -   depends on: ctype_alpha</span>
</span><span class='line'>  <span class="c1">// *     example 1: str_word_count(&quot;Hello fri3nd, you&#39;re\r\n       looking          good today!&quot;, 1);</span>
</span><span class='line'>  <span class="c1">// *     returns 1: [&#39;Hello&#39;, &#39;fri&#39;, &#39;nd&#39;, &quot;you&#39;re&quot;, &#39;looking&#39;, &#39;good&#39;, &#39;today&#39;]</span>
</span><span class='line'>  <span class="c1">// *     example 2: str_word_count(&quot;Hello fri3nd, you&#39;re\r\n       looking          good today!&quot;, 2);</span>
</span><span class='line'>  <span class="c1">// *     returns 2: {0: &#39;Hello&#39;, 6: &#39;fri&#39;, 10: &#39;nd&#39;, 14: &quot;you&#39;re&quot;, 29: &#39;looking&#39;, 46: &#39;good&#39;, 51: &#39;today&#39;}</span>
</span><span class='line'>  <span class="c1">// *     example 3: str_word_count(&quot;Hello fri3nd, you&#39;re\r\n       looking          good today!&quot;, 1, &#39;\u00e0\u00e1\u00e3\u00e73&#39;);</span>
</span><span class='line'>  <span class="c1">// *     returns 3: [&#39;Hello&#39;, &#39;fri3nd&#39;, &#39;youre&#39;, &#39;looking&#39;, &#39;good&#39;, &#39;today&#39;]</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">cl</span> <span class="o">=</span> <span class="nx">charlist</span> <span class="o">&amp;&amp;</span> <span class="nx">charlist</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">chr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">tmpStr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">c</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">wArr</span> <span class="o">=</span> <span class="p">[],</span>
</span><span class='line'>    <span class="nx">wC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">assoc</span> <span class="o">=</span> <span class="p">{},</span>
</span><span class='line'>    <span class="nx">aC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">reg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">match</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// BEGIN STATIC</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">_preg_quote</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">(</span><span class="nx">str</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!&lt;&gt;\|\:])/g</span><span class="p">,</span> <span class="s1">&#39;\\$1&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>    <span class="nx">_getWholeChar</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Use for rare cases of non-BMP characters</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">code</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">code</span> <span class="o">&lt;</span> <span class="mh">0xD800</span> <span class="o">||</span> <span class="nx">code</span> <span class="o">&gt;</span> <span class="mh">0xDFFF</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">str</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="mh">0xD800</span> <span class="o">&lt;=</span> <span class="nx">code</span> <span class="o">&amp;&amp;</span> <span class="nx">code</span> <span class="o">&lt;=</span> <span class="mh">0xDBFF</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// High surrogate (could change last hex to 0xDB7F to treat high private surrogates as single characters)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">throw</span> <span class="s1">&#39;High surrogate without following low surrogate&#39;</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">next</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="mh">0xDC00</span> <span class="o">&gt;</span> <span class="nx">next</span> <span class="o">||</span> <span class="nx">next</span> <span class="o">&gt;</span> <span class="mh">0xDFFF</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">throw</span> <span class="s1">&#39;High surrogate without following low surrogate&#39;</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">str</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="nx">str</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="c1">// Low surrogate (0xDC00 &lt;= code &amp;&amp; code &lt;= 0xDFFF)</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">throw</span> <span class="s1">&#39;Low surrogate without preceding high surrogate&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">prev</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="mh">0xD800</span> <span class="o">&gt;</span> <span class="nx">prev</span> <span class="o">||</span> <span class="nx">prev</span> <span class="o">&gt;</span> <span class="mh">0xDBFF</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// (could change last hex to 0xDB7F to treat high private surrogates as single characters)</span>
</span><span class='line'>        <span class="k">throw</span> <span class="s1">&#39;Low surrogate without preceding high surrogate&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span> <span class="c1">// We can pass over low surrogates now as the second component in a pair which we have already processed</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="c1">// END STATIC</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">cl</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">reg</span> <span class="o">=</span> <span class="s1">&#39;^(&#39;</span> <span class="o">+</span> <span class="nx">_preg_quote</span><span class="p">(</span><span class="nx">_getWholeChar</span><span class="p">(</span><span class="nx">charlist</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">cl</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">((</span><span class="nx">chr</span> <span class="o">=</span> <span class="nx">_getWholeChar</span><span class="p">(</span><span class="nx">charlist</span><span class="p">,</span> <span class="nx">i</span><span class="p">))</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">continue</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">reg</span> <span class="o">+=</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="nx">_preg_quote</span><span class="p">(</span><span class="nx">chr</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="nx">reg</span> <span class="o">+=</span> <span class="s1">&#39;)$&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">reg</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">reg</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">((</span><span class="nx">c</span> <span class="o">=</span> <span class="nx">_getWholeChar</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">i</span><span class="p">))</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">continue</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="nx">match</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctype_alpha</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">reg</span> <span class="o">&amp;&amp;</span> <span class="nx">c</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="nx">reg</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">((</span><span class="nx">i</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span> <span class="o">!==</span> <span class="nx">len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">c</span> <span class="o">===</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="c1">// No hyphen at beginning or end unless allowed in charlist (or locale)</span>
</span><span class='line'>    <span class="p">(</span><span class="nx">i</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">c</span> <span class="o">===</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">);</span> <span class="c1">// No apostrophe at beginning unless allowed in charlist (or locale)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">tmpStr</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">format</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">aC</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">tmpStr</span> <span class="o">=</span> <span class="nx">tmpStr</span> <span class="o">+</span> <span class="nx">c</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="nx">len</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">||</span> <span class="o">!</span><span class="nx">match</span> <span class="o">&amp;&amp;</span> <span class="nx">tmpStr</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">format</span> <span class="o">!==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">wArr</span><span class="p">[</span><span class="nx">wArr</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span> <span class="o">=</span> <span class="nx">tmpStr</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">assoc</span><span class="p">[</span><span class="nx">aC</span><span class="p">]</span> <span class="o">=</span> <span class="nx">tmpStr</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">tmpStr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">wC</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">format</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">wC</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">format</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">wArr</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">format</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">assoc</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">throw</span> <span class="s1">&#39;You have supplied an incorrect format&#39;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/kvz/phpjs/blob/master/functions/strings/str_word_count.js">view on github</a></li>
<li><a href="https://github.com/kvz/phpjs/edit/master/functions/strings/str_word_count.js">edit on github</a></li>
</ul>


<h3>Example 1</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">str_word_count</span><span class="p">(</span><span class="s2">&quot;Hello fri3nd, you&#39;re\r\n       looking          good today!&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="p">[</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="s1">&#39;fri&#39;</span><span class="p">,</span> <span class="s1">&#39;nd&#39;</span><span class="p">,</span> <span class="s2">&quot;you&#39;re&quot;</span><span class="p">,</span> <span class="s1">&#39;looking&#39;</span><span class="p">,</span> <span class="s1">&#39;good&#39;</span><span class="p">,</span> <span class="s1">&#39;today&#39;</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Example 2</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">str_word_count</span><span class="p">(</span><span class="s2">&quot;Hello fri3nd, you&#39;re\r\n       looking          good today!&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="p">{</span><span class="mi">0</span><span class="o">:</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="o">:</span> <span class="s1">&#39;fri&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="o">:</span> <span class="s1">&#39;nd&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="o">:</span> <span class="s2">&quot;you&#39;re&quot;</span><span class="p">,</span> <span class="mi">29</span><span class="o">:</span> <span class="s1">&#39;looking&#39;</span><span class="p">,</span> <span class="mi">46</span><span class="o">:</span> <span class="s1">&#39;good&#39;</span><span class="p">,</span> <span class="mi">51</span><span class="o">:</span> <span class="s1">&#39;today&#39;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Example 3</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">str_word_count</span><span class="p">(</span><span class="s2">&quot;Hello fri3nd, you&#39;re\r\n       looking          good today!&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;\u00e0\u00e1\u00e3\u00e73&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="p">[</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="s1">&#39;fri3nd&#39;</span><span class="p">,</span> <span class="s1">&#39;youre&#39;</span><span class="p">,</span> <span class="s1">&#39;looking&#39;</span><span class="p">,</span> <span class="s1">&#39;good&#39;</span><span class="p">,</span> <span class="s1">&#39;today&#39;</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other PHP functions in the strings extension</h3>

<!-- Generated by Rakefile:build -->


<ul>
<li><a href="/functions/addcslashes">addcslashes</a></li>
<li><a href="/functions/addslashes">addslashes</a></li>
<li><a href="/functions/bin2hex">bin2hex</a></li>
<li><a href="/functions/chop">chop</a></li>
<li><a href="/functions/chr">chr</a></li>
<li><a href="/functions/chunk_split">chunk_split</a></li>
<li><a href="/functions/convert_cyr_string">convert_cyr_string</a></li>
<li><a href="/functions/convert_uuencode">convert_uuencode</a></li>
<li><a href="/functions/count_chars">count_chars</a></li>
<li><a href="/functions/crc32">crc32</a></li>
<li><a href="/functions/echo">echo</a></li>
<li><a href="/functions/explode">explode</a></li>
<li><a href="/functions/get_html_translation_table">get_html_translation_table</a></li>
<li><a href="/functions/html_entity_decode">html_entity_decode</a></li>
<li><a href="/functions/htmlentities">htmlentities</a></li>
<li><a href="/functions/htmlspecialchars">htmlspecialchars</a></li>
<li><a href="/functions/htmlspecialchars_decode">htmlspecialchars_decode</a></li>
<li><a href="/functions/implode">implode</a></li>
<li><a href="/functions/join">join</a></li>
<li><a href="/functions/lcfirst">lcfirst</a></li>
<li><a href="/functions/levenshtein">levenshtein</a></li>
<li><a href="/functions/localeconv">localeconv</a></li>
<li><a href="/functions/ltrim">ltrim</a></li>
<li><a href="/functions/md5">md5</a></li>
<li><a href="/functions/md5_file">md5_file</a></li>
<li><a href="/functions/metaphone">metaphone</a></li>
<li><a href="/functions/money_format">money_format</a></li>
<li><a href="/functions/nl2br">nl2br</a></li>
<li><a href="/functions/nl_langinfo">nl_langinfo</a></li>
<li><a href="/functions/number_format">number_format</a></li>
<li><a href="/functions/ord">ord</a></li>
<li><a href="/functions/parse_str">parse_str</a></li>
<li><a href="/functions/printf">printf</a></li>
<li><a href="/functions/quoted_printable_decode">quoted_printable_decode</a></li>
<li><a href="/functions/quoted_printable_encode">quoted_printable_encode</a></li>
<li><a href="/functions/quotemeta">quotemeta</a></li>
<li><a href="/functions/rtrim">rtrim</a></li>
<li><a href="/functions/setlocale">setlocale</a></li>
<li><a href="/functions/sha1">sha1</a></li>
<li><a href="/functions/sha1_file">sha1_file</a></li>
<li><a href="/functions/similar_text">similar_text</a></li>
<li><a href="/functions/soundex">soundex</a></li>
<li><a href="/functions/split">split</a></li>
<li><a href="/functions/sprintf">sprintf</a></li>
<li><a href="/functions/sscanf">sscanf</a></li>
<li><a href="/functions/str_getcsv">str_getcsv</a></li>
<li><a href="/functions/str_ireplace">str_ireplace</a></li>
<li><a href="/functions/str_pad">str_pad</a></li>
<li><a href="/functions/str_repeat">str_repeat</a></li>
<li><a href="/functions/str_replace">str_replace</a></li>
<li><a href="/functions/str_rot13">str_rot13</a></li>
<li><a href="/functions/str_shuffle">str_shuffle</a></li>
<li><a href="/functions/str_split">str_split</a></li>
<li><a href="/functions/str_word_count">str_word_count</a></li>
<li><a href="/functions/strcasecmp">strcasecmp</a></li>
<li><a href="/functions/strchr">strchr</a></li>
<li><a href="/functions/strcmp">strcmp</a></li>
<li><a href="/functions/strcoll">strcoll</a></li>
<li><a href="/functions/strcspn">strcspn</a></li>
<li><a href="/functions/strip_tags">strip_tags</a></li>
<li><a href="/functions/stripos">stripos</a></li>
<li><a href="/functions/stripslashes">stripslashes</a></li>
<li><a href="/functions/stristr">stristr</a></li>
<li><a href="/functions/strlen">strlen</a></li>
<li><a href="/functions/strnatcasecmp">strnatcasecmp</a></li>
<li><a href="/functions/strnatcmp">strnatcmp</a></li>
<li><a href="/functions/strncasecmp">strncasecmp</a></li>
<li><a href="/functions/strncmp">strncmp</a></li>
<li><a href="/functions/strpbrk">strpbrk</a></li>
<li><a href="/functions/strpos">strpos</a></li>
<li><a href="/functions/strrchr">strrchr</a></li>
<li><a href="/functions/strrev">strrev</a></li>
<li><a href="/functions/strripos">strripos</a></li>
<li><a href="/functions/strrpos">strrpos</a></li>
<li><a href="/functions/strspn">strspn</a></li>
<li><a href="/functions/strstr">strstr</a></li>
<li><a href="/functions/strtok">strtok</a></li>
<li><a href="/functions/strtolower">strtolower</a></li>
<li><a href="/functions/strtoupper">strtoupper</a></li>
<li><a href="/functions/strtr">strtr</a></li>
<li><a href="/functions/substr">substr</a></li>
<li><a href="/functions/substr_compare">substr_compare</a></li>
<li><a href="/functions/substr_count">substr_count</a></li>
<li><a href="/functions/substr_replace">substr_replace</a></li>
<li><a href="/functions/trim">trim</a></li>
<li><a href="/functions/ucfirst">ucfirst</a></li>
<li><a href="/functions/ucwords">ucwords</a></li>
<li><a href="/functions/vprintf">vprintf</a></li>
<li><a href="/functions/vsprintf">vsprintf</a></li>
<li><a href="/functions/wordwrap">wordwrap</a></li>
</ul>


<h2>Legacy comments</h2>

<p>These were imported from our old site. Please use disqus below for new comments</p>

<div style="overflow-y: scroll; max-height: 500px;">
<!-- Generated by Rakefile:build -->

<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2010-02-13 08:29:31 <br />
@Bug?: Yes, you are correct. Thanks for the feedback. I have now fixed it in Git: http://github.com/kvz/phpjs/raw/master/functions/strings/str_word_count.js . Note that the new version requires ctype_alpha now (and which I also needed to update now along with a lot of other functions dependent on RegExp.test()), and that function depends on setlocale() because this function should check in a way that potentially supports what other locales consider a word. I also added support for the very rare non-BMP characters, and as per PHP, allowed hyphens in the middle or apostrophes at the middle or end (and everywhere if the charlist includes these).
<hr />


<strong>
Bug?
</strong>
on 2010-02-03 12:12:59 <br />
The javascript function returns 5 words for this string:

<pre><code>
Lorem ipsum dolor asdf asdf asdf
</code></pre>

And 6 words for this one:

<pre><code>
Lorem ipsum dolor asdf asdf asdf.
</code></pre>

The PHP function returns 6 for both.

Cheers,

Chris
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-06-18 08:03:12 <br />
I believe that to do this correctly for not only Chinese but other languages, we&#8217;ll need to take a good look at the source code, specifically for PHP 6, since that is where full Unicode support is being added.

We might be able to use XRegExp (see http://stevenlevithan.com/regex/xregexp/ ) and its Unicode plug-in (at http://blog.stevenlevithan.com/archives/xregexp-unicode-plugin ) for our preg_ functions and then make str_word_count() dependent on it, though that won&#8217;t really help determine what a &quot;word&quot; is (since, in Chinese, a character is technically only a graphical morpheme, and not necessarily also an independent word), though at least it will tell us definitively what a &quot;letter&quot; is. Of course, we can just go back to the source to see how PHP interprets a &quot;word&quot; since we&#8217;re aiming for that anyways, but again, that will take some work, especially if we wish to make it work for other languages as well as Chinese. I&#8217;m pretty busy for now, but feel free to take a shot at it if you like.

FYI, as you can see by your Chinese characters getting mangled, the site is having some problems at the moment with Unicode characters, so if you need to refer to any in the future, maybe you could try using entities or the JavaScript Unicode escape sequences instead (e.g., \u0020). But I think the issue is beyond just Chinese (though Chinese in particular also raises the particular need for also handling characters beyond the Basic Multilingual Plane (BMP) since some Chinese characters fall beyond this plane&#8211;in JavaScript, such characters must be represented by two Unicode characters called surrogates (characters which are not used outside of such pairs), so we can&#8217;t rely on the length of the string&#8211;see http://phpjs.org/functions/strlen for a solution).
<hr />


<strong>
Chris
</strong>
on 2009-06-13 01:18:53 <br />
This function doesn&#8217;t work quite like PHP&#8217;s in that it fails to count each single Chinese character as an entire word, eg.:

?? hello ?

Is four words&#8230;
<hr />


</div>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://phpjs.org/functions/str_word_count/index.html" data-via="phpjs" data-counturl="http://phpjs.org/functions/str_word_count/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Kevin van Zonneveld -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
   -
  <span class="credit">Theme by <a href="http://melandri.net/2012/07/23/darkstripes-octopress-theme-released/">alessandro melandri</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phpjs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://phpjs.org/functions/str_word_count/index.html';
        var disqus_url = 'http://phpjs.org/functions/str_word_count/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
