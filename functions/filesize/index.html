
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JavaScript filesize function - php.js</title>
  <meta name="author" content="Kevin van Zonneveld">

  
  <meta name="description" content="JavaScript filesize function A JavaScript equivalent of PHP&#8217;s filesize filesystem/filesize.js raw on github 1
2
3
4
5
6
7
8
9
10
11
12
13
14 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phpjs.org/functions/filesize/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="php.js" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-63083-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">php</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">.js</a></h1>
  
    <h2>A resource of php functions in JavaScript</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phpjs.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/functions">Functions</a></li>
  <li><a href="/authors">Authors</a></li>
  <li><a target="_blank" href="https://github.com/kvz/phpjs/wiki/_pages">Wiki</a></li>
  <li><a target="_blank"  href="http://twitter.com/phpjs">@phpjs</a></li>
  <li><a target="_blank"  href="http://identi.ca/brettz9">@brettz9</a></li>
  <li><a target="_blank"  href="http://twitter.com/kvz">@kvz</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">JavaScript filesize function</h1>
    
  </header>
  
  <!-- Generated by Rakefile:build -->


<p>A JavaScript equivalent of PHP&#8217;s filesize</p>

<figure class='code'><figcaption><span>filesystem/filesize.js </span><a href='https://raw.github.com/kvz/phpjs/master/functions/filesystem/filesize.js'>raw on github </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">filesize</span> <span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// http://kevin.vanzonneveld.net</span>
</span><span class='line'>  <span class="c1">// +   original by: Enrique Gonzalez</span>
</span><span class='line'>  <span class="c1">// +      input by: Jani Hartikainen</span>
</span><span class='line'>  <span class="c1">// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)</span>
</span><span class='line'>  <span class="c1">// +   improved by: T. Wild</span>
</span><span class='line'>  <span class="c1">// %        note 1: This function uses XmlHttpRequest and cannot retrieve resource from different domain.</span>
</span><span class='line'>  <span class="c1">// %        note 1: Synchronous so may lock up browser, mainly here for study purposes.</span>
</span><span class='line'>  <span class="c1">// *     example 1: filesize(&#39;http://kevin.vanzonneveld.net/pj_test_supportfile_1.htm&#39;);</span>
</span><span class='line'>  <span class="c1">// *     returns 1: &#39;3&#39;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">ActiveXObject</span> <span class="o">?</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Microsoft.XMLHTTP&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;XMLHttpRequest not supported&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">req</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;HEAD&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">req</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;No getResponseHeader!&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s1">&#39;Content-Length&#39;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;No Content-Length!&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">req</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s1">&#39;Content-Length&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/kvz/phpjs/blob/master/functions/filesystem/filesize.js">view on github</a></li>
<li><a href="https://github.com/kvz/phpjs/edit/master/functions/filesystem/filesize.js">edit on github</a></li>
</ul>


<h3>Example 1</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">filesize</span><span class="p">(</span><span class="s1">&#39;http://kevin.vanzonneveld.net/pj_test_supportfile_1.htm&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;3&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other PHP functions in the filesystem extension</h3>

<!-- Generated by Rakefile:build -->


<ul>
<li><a href="/functions/basename">basename</a></li>
<li><a href="/functions/dirname">dirname</a></li>
<li><a href="/functions/fclose">fclose</a></li>
<li><a href="/functions/feof">feof</a></li>
<li><a href="/functions/fgetc">fgetc</a></li>
<li><a href="/functions/fgetcsv">fgetcsv</a></li>
<li><a href="/functions/fgets">fgets</a></li>
<li><a href="/functions/fgetss">fgetss</a></li>
<li><a href="/functions/file">file</a></li>
<li><a href="/functions/file_exists">file_exists</a></li>
<li><a href="/functions/file_get_contents">file_get_contents</a></li>
<li><a href="/functions/filemtime">filemtime</a></li>
<li><a href="/functions/filesize">filesize</a></li>
<li><a href="/functions/fopen">fopen</a></li>
<li><a href="/functions/fpassthru">fpassthru</a></li>
<li><a href="/functions/fread">fread</a></li>
<li><a href="/functions/fscanf">fscanf</a></li>
<li><a href="/functions/fseek">fseek</a></li>
<li><a href="/functions/ftell">ftell</a></li>
<li><a href="/functions/pathinfo">pathinfo</a></li>
<li><a href="/functions/pclose">pclose</a></li>
<li><a href="/functions/popen">popen</a></li>
<li><a href="/functions/readfile">readfile</a></li>
<li><a href="/functions/realpath">realpath</a></li>
<li><a href="/functions/rewind">rewind</a></li>
</ul>


<h2>Legacy comments</h2>

<p>These were imported from our old site. Please use disqus below for new comments</p>

<div style="overflow-y: scroll; max-height: 500px;">
<!-- Generated by Rakefile:build -->

<strong>
<a href="http://f-code.web.id" rel="nofollow">Prast</a>
</strong>
on 2011-08-26 09:49:35 <br />
how about error in internet explorer as Dorian mentioned before? 
<hr />


<strong>
<a href="none" rel="nofollow">Dorian</a>
</strong>
on 2010-10-07 19:16:40 <br />
i have a problem for use this function on Internet Explorer, missing:

Object doesn&#8217;t support this property or method

in this line: 
<pre><code>if (!req.getResponseHeader)</code></pre>

broken and not continue.

¿what is the solution for this problem?
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-12-10 17:33:31 <br />
@ Arcanis &amp;amp; T. Wild: Thanks for your input guys. T.Wild, I&#8217;ve implemented your suggestion and am curious what people will say about this approach. If the responses are good we might implement it in other cases as well.
<hr />


<strong>
T.Wild
</strong>
on 2008-12-08 13:35:55 <br />
@Arcanis
While it may be stupid not to throw an error when the content length header isn&#8217;t sent; when JavaScript throws an error the script halts, just try this:
<pre><code>
throw new Error('error1');
alert(&amp;quot;FOO&amp;quot;); //This is not called
</code></pre>
You don&#8217;t want your entire script to halt simply because the server fails to send the correct headers which isn&#8217;t a client side error.
However the XHR is different it is an error on the client side and does warrant an error, but even then I&#8217;d rather it return false rather than throw an error since PHP returns false on any error, not halt your script.
Maybe this would work?
<pre><code>
//This allows the error to be thrown while still returning false;
try{
     throw new Error('error1');
}catch(e){
    return false;
}

//In this case the error is still thrown AND the alert is called;
try{
     throw new Error('error1');
}catch(e){};
alert(&amp;quot;FOO&amp;quot;);
</code></pre>
I know I may not be clear on what I&#8217;m saying but I hope you see what I&#8217;m getting at.
<hr />


<strong>
<a href="http://www.arcanis.fr" rel="nofollow">Arcanis</a>
</strong>
on 2008-12-07 19:30:51 <br />
I think it&#8217;s stupid to return false when there is no content-length, and to return an error when there is no XHR.
Both of them are errors, no ? I think you must send an error if the content-length is not specified.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-11-18 12:23:38 <br />
Jani Hartikainen: Fair enough!
<hr />


<strong>
<a href="http://codeutopia.net/" rel="nofollow">Jani Hartikainen</a>
</strong>
on 2008-11-17 09:12:53 <br />
While the whole method is a bit dubious (as pointed out by Onno Marsman), it might be a general improvement to check for window.XMLHttpRequest, rather than relying on error catching. To my understanding, catching exceptions (errors?) is slow.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-11-14 21:23:17 <br />
@ Onno Marsman: Haha, that&#8217;s ok Onno! appreciated. And about the compiler&#8230; Man I&#8217;m so busy :| Will try to dedicate more time to it.
<hr />


<strong>
Onno Marsman
</strong>
on 2008-11-14 16:21:05 <br />
K thnx, I will not bother you with it again ;)
I hope that compiler will soon be available.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-11-14 14:17:53 <br />
@ Onno Marsman: I&#8217;ve made it return false if it doesn&#8217;t. We&#8217;ve had this discussion before indeed. I know how you feel about this, and you know I agree but these functions serve a purpose of their own. We&#8217;ll make sure they&#8217;ll not be included by default with our future compiler. Thanks for your input Onno.
<hr />


<strong>
Onno Marsman
</strong>
on 2008-11-14 12:17:52 <br />
What if the &amp;quot;Content-Length&amp;quot; header does not exist?

Furthermore: it&#8217;s really weird to use these types of functions. Making an Ajax request which executes the filesize function server-side would be many times better. But the same goes for something like file_get_contents and this has pointed out before. I really think that in the future these types of functions (along with functions like sleep, which also nobody should use) should not remain in the main download of php.js, but optionally available.
<hr />


</div>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://phpjs.org/functions/filesize/index.html" data-via="phpjs" data-counturl="http://phpjs.org/functions/filesize/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Kevin van Zonneveld -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
   -
  <span class="credit">Theme by <a href="http://melandri.net/2012/07/23/darkstripes-octopress-theme-released/">alessandro melandri</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phpjs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://phpjs.org/functions/filesize/index.html';
        var disqus_url = 'http://phpjs.org/functions/filesize/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
